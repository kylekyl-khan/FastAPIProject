<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>公司通訊錄</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Outlook Web Add-in Office.js（在非 Outlook 環境不會壞，只是沒作用） -->
  <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>

  <style>
    :root {
      --bg: #f5f6f8;
      --primary: #2563eb;
      --primary-soft: #eff6ff;
      --border: #d4d4d8;
      --text-main: #111827;
      --text-sub: #6b7280;
      --radius-xl: 18px;
      --shadow-soft: 0 6px 18px rgba(15, 23, 42, 0.09);
      --transition-fast: 0.18s ease-in-out;
      --font: -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      padding: 0;
      font-family: var(--font);
      background: var(--bg);
      color: var(--text-main);
    }

    #app {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    header {
      padding: 16px 24px 8px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 16px;
    }

    .brand-title {
      font-size: 20px;
      font-weight: 600;
      letter-spacing: 0.03em;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .brand-badge {
      padding: 2px 8px;
      border-radius: 999px;
      font-size: 10px;
      border: 1px solid var(--border);
      color: var(--text-sub);
    }

    .status-pill {
      padding: 4px 10px;
      border-radius: 999px;
      font-size: 11px;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      border: 1px solid var(--border);
      background: #fff;
      color: var(--text-sub);
    }

    .status-dot {
      width: 7px;
      height: 7px;
      border-radius: 999px;
      background: #22c55e;
    }

    .status-dot.warn {
      background: #f97316;
    }

    .search-bar {
      padding: 0 24px 12px;
      display: flex;
      gap: 8px;
      align-items: center;
    }

    .search-input {
      flex: 1;
      padding: 8px 10px;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: #fff;
      font-size: 13px;
      outline: none;
    }

    .search-input:focus {
      border-color: var(--primary);
      box-shadow: 0 0 0 2px rgba(37, 99, 235, 0.08);
    }

    .search-btn {
      padding: 8px 14px;
      border-radius: 999px;
      background: var(--primary);
      border: none;
      color: #fff;
      font-size: 13px;
      cursor: pointer;
      transition: var(--transition-fast);
      white-space: nowrap;
    }

    .search-btn:hover {
      transform: translateY(-1px);
      box-shadow: var(--shadow-soft);
    }

    main {
      flex: 1;
      padding: 4px 24px 18px;
    }

    /* 頂層卡片 view */
    #root-view {
      display: block;
    }

    .root-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
      gap: 14px;
      margin-top: 10px;
    }

    .root-card {
      background: #fff;
      border-radius: var(--radius-xl);
      padding: 14px 14px 12px;
      border: 1px solid var(--border);
      cursor: pointer;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      gap: 8px;
      box-shadow: 0 2px 5px rgba(15, 23, 42, 0.04);
      transition: var(--transition-fast);
    }

    .root-card:hover {
      box-shadow: var(--shadow-soft);
      transform: translateY(-2px);
      border-color: var(--primary);
    }

    .root-name {
      font-size: 16px;
      font-weight: 600;
    }

    .root-desc {
      font-size: 11px;
      color: var(--text-sub);
    }

    .root-action {
      font-size: 11px;
      color: var(--primary);
      display: flex;
      align-items: center;
      gap: 4px;
    }

    /* org-view split layout */
    #org-view {
      display: none;
      gap: 16px;
      margin-top: 6px;
      height: calc(100vh - 120px);
      max-height: 640px;
    }

    #org-view.visible {
      display: flex;
    }

    #tree-panel {
      width: 30%;
      min-width: 210px;
      background: #fff;
      border-radius: var(--radius-xl);
      padding: 10px 8px;
      border: 1px solid var(--border);
      box-shadow: 0 2px 8px rgba(15, 23, 42, 0.04);
      overflow-y: auto;
    }

    #detail-panel {
      flex: 1;
      background: #fff;
      border-radius: var(--radius-xl);
      padding: 10px 12px;
      border: 1px solid var(--border);
      box-shadow: 0 2px 8px rgba(15, 23, 42, 0.04);
      display: flex;
      flex-direction: column;
      gap: 8px;
      overflow: hidden;
    }

    #breadcrumb {
      font-size: 11px;
      color: var(--text-sub);
    }

    #node-title {
      font-size: 16px;
      font-weight: 600;
    }

    #node-sub {
      font-size: 11px;
      color: var(--text-sub);
    }

    /* TreeView */
    .tree-root,
    .tree-children {
      list-style: none;
      margin: 0;
      padding-left: 10px;
    }

    .tree-node {
      display: flex;
      align-items: center;
      gap: 4px;
      padding: 4px 4px;
      border-radius: 8px;
      font-size: 12px;
      cursor: pointer;
      color: var(--text-main);
    }

    .tree-node:hover {
      background: var(--primary-soft);
    }

    .tree-node.active {
      background: var(--primary);
      color: #fff;
    }

    .tree-toggle {
      width: 14px;
      text-align: center;
      font-size: 10px;
      user-select: none;
      color: var(--text-sub);
    }

    .tree-toggle.hidden {
      visibility: hidden;
    }

    .tree-label {
      flex: 1;
      white-space: nowrap;
      text-overflow: ellipsis;
      overflow: hidden;
    }

    .tree-loading {
      font-size: 9px;
      color: var(--text-sub);
      margin-left: 4px;
    }

    /* Member list */
    #member-list-wrap {
      flex: 1;
      overflow: auto;
      border-radius: 12px;
      border: 1px solid #e5e7eb;
      padding: 6px;
      margin-top: 2px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 12px;
    }

    thead {
      background: #f9fafb;
      position: sticky;
      top: 0;
      z-index: 1;
    }

    th, td {
      padding: 6px 6px;
      border-bottom: 1px solid #f1f5f9;
      text-align: left;
    }

    th {
      font-weight: 600;
      color: var(--text-sub);
      font-size: 11px;
    }

    tr:hover td {
      background: #f9fafb;
    }

    .badge-role {
      padding: 2px 6px;
      border-radius: 999px;
      background: #eff6ff;
      color: #1d4ed8;
      font-size: 10px;
      display: inline-block;
    }

    .btn-pill {
      padding: 2px 6px;
      border-radius: 999px;
      font-size: 10px;
      border: 1px solid var(--border);
      background: #fff;
      cursor: pointer;
      margin-right: 2px;
      transition: var(--transition-fast);
    }

    .btn-pill:hover {
      border-color: var(--primary);
      color: var(--primary);
      box-shadow: 0 1px 4px rgba(15, 23, 42, 0.08);
    }

    .empty-state {
      padding: 8px;
      font-size: 11px;
      color: var(--text-sub);
    }

    /* Toast */
    #toast-container {
      position: fixed;
      right: 14px;
      bottom: 14px;
      display: flex;
      flex-direction: column;
      gap: 6px;
      z-index: 9999;
    }

    .toast {
      min-width: 180px;
      padding: 8px 10px;
      font-size: 11px;
      border-radius: 10px;
      background: #111827;
      color: #f9fafb;
      box-shadow: 0 6px 18px rgba(15, 23, 42, 0.25);
      display: flex;
      align-items: flex-start;
      gap: 6px;
      opacity: 0;
      transform: translateY(6px);
      transition: all 0.18s ease-out;
    }

    .toast.show {
      opacity: 1;
      transform: translateY(0);
    }

    .toast-type {
      font-size: 14px;
      line-height: 1;
      margin-top: -1px;
    }

    .toast-msg {
      flex: 1;
    }

    .toast-close {
      cursor: pointer;
      font-size: 11px;
      opacity: 0.6;
    }

    .toast-info { background: #111827; }
    .toast-success { background: #16a34a; }
    .toast-warn { background: #f97316; }
    .toast-error { background: #dc2626; }

    /* Modal（保留掛點，可之後擴充詳細資料） */
    #modal-overlay {
      position: fixed;
      inset: 0;
      background: rgba(15, 23, 42, 0.32);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 9000;
    }

    #modal-overlay.visible {
      display: flex;
    }

    .modal {
      background: #fff;
      border-radius: 16px;
      padding: 16px 18px;
      width: min(380px, 92vw);
      box-shadow: var(--shadow-soft);
      font-size: 12px;
    }

    .hidden { display: none !important; }
  </style>
</head>

<body>
<div id="app">
  <header>
    <div class="brand-title">
      公司通訊錄
      <span class="brand-badge">Demo Preview</span>
    </div>
    <div id="outlook-status" class="status-pill">
      <span class="status-dot warn"></span>
      <span>檢查 Outlook 環境中...</span>
    </div>
  </header>

  <div class="search-bar">
    <input id="search-input" class="search-input" type="text"
           placeholder="搜尋姓名、單位關鍵字（Demo：前端僅做本地過濾，可再串搜尋 API）" />
    <button id="search-btn" class="search-btn">搜尋</button>
  </div>

  <main>
    <!-- 首頁：頂層單位列表 -->
    <section id="root-view">
      <div id="root-grid" class="root-grid">
        <!-- 由 script.js 動態產生卡片 -->
      </div>
    </section>

    <!-- 組織樹 + 成員清單 -->
    <section id="org-view">
      <aside id="tree-panel">
        <!-- TreeView -->
      </aside>
      <section id="detail-panel">
        <div id="breadcrumb"></div>
        <div id="node-title">請從左側選擇部門或分組</div>
        <div id="node-sub">點擊樹狀節點後，這裡會顯示該單位資訊與人員列表。</div>
        <div id="member-list-wrap">
          <div class="empty-state">尚未選取任何分組。</div>
        </div>
      </section>
    </section>
  </main>

  <div id="toast-container"></div>

  <div id="modal-overlay">
    <div class="modal">
      <div id="modal-content">Modal content</div>
    </div>
  </div>
</div>

<script src="script.js"></script>
</body>
</html>
